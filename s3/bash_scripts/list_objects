#!/usr/bin/env bash
set -euo pipefail

# Script: Listar todos os objetos de um bucket S3
# Uso: ./list_objects <nome-do-bucket>
# Exemplo: ./list_objects meu-bucket-teste

if [ -z "${1:-}" ]; then
    echo "‚ùå Erro: Nome do bucket n√£o informado"
    echo "Uso: $0 <nome-do-bucket>"
    echo "Exemplo: $0 meu-bucket-teste"
    exit 1
fi

BUCKET_NAME="$1"

echo "üìã Listando objetos no bucket: $BUCKET_NAME..."
echo ""

if aws s3api list-objects-v2 --bucket "$BUCKET_NAME" \
  --output table \
  --query 'Contents[].{Key: Key, Size: Size, LastModified: LastModified}' 2>/dev/null; then
    echo "‚úÖ Listagem conclu√≠da"
else
    echo "‚ùå Erro ao listar objetos. Bucket existe?"
    exit 1
fi

#!/usr/bin/env bash
echo "== Create Bucket =="
set -euo pipefail

# Script: Criar um novo bucket S3
# Uso: ./create_bucket <nome-do-bucket>
# Exemplo: ./create_bucket meu-bucket-unico-12345

if [ -z "${1:-}" ]; then
    echo "‚ùå Erro: Nome do bucket n√£o informado"
    echo "Uso: $0 <nome-do-bucket>"
    echo "Exemplo: $0 meu-bucket-unico-12345"
    exit 1
fi

BUCKET_NAME="$1"

# Validar se bucket j√° existe
if aws s3api head-bucket --bucket "$BUCKET_NAME" 2>/dev/null; then
    echo "‚ùå Erro: Bucket '$BUCKET_NAME' j√° existe"
    exit 1
fi

echo "üì¶ Criando bucket: $BUCKET_NAME..."
aws s3api create-bucket --bucket "$BUCKET_NAME" \
  --query 'Location' \
  --output text | sed 's|^.*//||' || exit 1

echo "‚úÖ Bucket criado com sucesso!"


